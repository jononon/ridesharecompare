<head>
  <link href='//fonts.googleapis.com/css?family=Roboto' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" type="text/css" href="bootstrap/css/bootstrap.min.css">
  <script type="text/javascript" src="//code.jquery.com/jquery-1.11.0.min.js"></script>
  <script type="text/javascript" src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
  <script type="text/javascript" src="bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="js.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
  <div class="page-header">
    <h1>RideShareCompare</h1>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading">Map</div>
    <div class="panel-body" style="height:100%;width:100%;">
      <input id="startSearch" type="text" class="form-control" placeholder="Search for an origin">
      <input id="destSearch" type="text" class="form-control" placeholder="Search for a destination">
      <div id="map" style="height:95%;width:100%;"></div>
        <script>
          function initMap() {

            var center = {lat: currLat, lng: currLng};
            // Create a map object and specify the DOM element for display.
            var map = new google.maps.Map(document.getElementById('map'), {
              mapTypeControl: true,
              mapTypeControlOptions: {
                style: google.maps.MapTypeControlStyle.DROPDOWN_MENU,
                mapTypeIds: [
                  google.maps.MapTypeId.ROADMAP,
                  google.maps.MapTypeId.HYBRID
                ]
              },
              scrollwheel: true,
              zoom: 13
            });

            var originSearchBox = new google.maps.places.SearchBox(document.getElementById('startSearch'));
            var destinationSearchBox = new google.maps.places.SearchBox(document.getElementById('destSearch'));

            navigator.geolocation.getCurrentPosition(function(location) {
              var currLoc = {
                lat: location.coords.latitude,
                lng: location.coords.longitude
              };
              map.setCenter(currLoc);
              var marker = new google.maps.Marker({
                map: map,
                position: currLoc,
                draggable: true,
                title: "Start"
              });
            });
            var destMarker;
            google.maps.event.addListener(map, "click", function(event) {
              if (destMarker == undefined)
                destMarker = new google.maps.Marker({
                  map:map,
                  position: event.latLng,
                  draggable: true,
                  title: "End"
                })
              else
                destMarker.setPosition(event.latLng);
            });
            destinationSearchBox.addListener('places_changed', function() {
              var places = destinationSearchBox.getPlaces();

              if (places.length == 0) {
                return;
              }
              places.forEach(function(place){
                if (destMarker == undefined)
                destMarker = new google.maps.Marker({
                  map:map,
                  position: place.geometry.location,
                  draggable: true,
                  title: "End"
                })
                else
                destMarker.setPosition(place.geometry.location);
              });
            });
            map.addListener('bounds_changed', function() {
              destinationSearchBox.setBounds(map.getBounds());
            });
          }
        </script>
        <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD-6Jk4A4RtRg_H0Kd0cFci3Bg52c8gzAY&libraries=places&callback=initMap"
          async defer></script>
    </div>
  </div>
  <div class="panel panel-default">
    <div class="panel-heading">Fares</div>
    <div class="panel-body">
      Fares calculated include any surge pricing. ETA is an estimate of how long it will take for the driver to pick you up.
    </div>
    <table id=prices class="table table-striped" style="font-size:14;"><tr><td>Please select your destination</table>
    <div class="panel-footer" id=lastUpdated></div>
  </div>
</body>
